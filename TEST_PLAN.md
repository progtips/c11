# План тестирования функций обработки статей

## Обзор

Данный документ описывает план тестирования функций "О чем статья", "Тезисы" и "Пост для Telegram".

## Подготовка к тестированию

### Требования
- Next.js приложение запущено (`npm run dev` или `pnpm dev`)
- Настроен файл `.env.local` с переменной `OPENROUTER_API_KEY`
- Доступ к интернету для парсинга статей и обращения к OpenRouter API

### Тестовые данные
Рекомендуется использовать реальные англоязычные статьи для тестирования:
- Пример URL: `https://techcrunch.com/2024/01/15/example-article`
- Или любой другой публичный URL англоязычной статьи

## 4.1. Функциональное тестирование

### Тест 1: Кнопка "О чем статья" с URL (статья не распарсена)

**Шаги:**
1. Открыть приложение в браузере
2. Ввести URL англоязычной статьи в поле "URL статьи"
3. Нажать кнопку "О чем статья" (без предварительного парсинга)
4. Дождаться завершения обработки

**Ожидаемый результат:**
- ✅ Показывается индикатор загрузки на кнопке "О чем статья"
- ✅ В блоке "Результат" появляется краткое описание статьи на русском языке (2-3 предложения)
- ✅ Описание соответствует содержанию статьи
- ✅ Нет ошибок в консоли браузера

**Проверка:**
- [ ] Индикатор загрузки работает корректно
- [ ] Результат на русском языке
- [ ] Результат содержит осмысленное описание статьи
- [ ] Время обработки приемлемое (< 30 секунд)

---

### Тест 2: Кнопка "О чем статья" с уже распарсенной статьей

**Шаги:**
1. Открыть приложение в браузере
2. Ввести URL статьи
3. Нажать "Парсить статью" и дождаться завершения
4. Нажать кнопку "О чем статья"

**Ожидаемый результат:**
- ✅ Используются данные из распарсенной статьи (не выполняется повторный парсинг)
- ✅ Результат появляется быстрее, чем в Тесте 1
- ✅ Результат корректен и на русском языке

**Проверка:**
- [ ] Не выполняется повторный запрос на парсинг
- [ ] Результат идентичен результату Теста 1
- [ ] Время обработки меньше, чем при парсинге с нуля

---

### Тест 3: Кнопка "Тезисы" с URL

**Шаги:**
1. Ввести URL статьи
2. Нажать кнопку "Тезисы"
3. Дождаться завершения

**Ожидаемый результат:**
- ✅ В результате появляется список из 5-7 тезисов
- ✅ Каждый тезис на отдельной строке с маркером списка
- ✅ Все тезисы на русском языке
- ✅ Тезисы отражают основные идеи статьи

**Проверка:**
- [ ] Количество тезисов: 5-7
- [ ] Форматирование корректное (маркеры списка)
- [ ] Все тезисы на русском языке
- [ ] Тезисы релевантны содержанию статьи

---

### Тест 4: Кнопка "Тезисы" с распарсенной статьей

**Шаги:**
1. Распарсить статью
2. Нажать "Тезисы"

**Ожидаемый результат:**
- ✅ Результат идентичен Тесту 3
- ✅ Обработка быстрее

**Проверка:**
- [ ] Результат корректен
- [ ] Используются данные из распарсенной статьи

---

### Тест 5: Кнопка "Пост для Telegram" с URL

**Шаги:**
1. Ввести URL статьи
2. Нажать "Пост для Telegram"
3. Дождаться завершения

**Ожидаемый результат:**
- ✅ Результат - пост для Telegram на русском языке
- ✅ Пост содержит эмодзи
- ✅ Пост структурирован (заголовок, основной текст)
- ✅ Длина поста: 200-400 слов
- ✅ Используется форматирование Markdown

**Проверка:**
- [ ] Пост на русском языке
- [ ] Есть эмодзи
- [ ] Структура поста читаемая
- [ ] Длина соответствует требованиям
- [ ] Markdown форматирование корректное

---

### Тест 6: Кнопка "Пост для Telegram" с распарсенной статьей

**Шаги:**
1. Распарсить статью
2. Нажать "Пост для Telegram"

**Ожидаемый результат:**
- ✅ Результат идентичен Тесту 5
- ✅ Обработка быстрее

**Проверка:**
- [ ] Результат корректен
- [ ] Используются данные из распарсенной статьи

---

## 4.2. Тестирование обработки ошибок

### Тест 7: Пустой URL

**Шаги:**
1. Оставить поле URL пустым
2. Нажать любую из кнопок ("О чем статья", "Тезисы", "Пост для Telegram")

**Ожидаемый результат:**
- ✅ Показывается сообщение об ошибке: "Пожалуйста, введите URL статьи" или "URL статьи не может быть пустым"
- ✅ Не выполняется запрос к API
- ✅ Индикатор загрузки не показывается

**Проверка:**
- [ ] Сообщение об ошибке понятное
- [ ] Запрос не отправляется
- [ ] UI остается в исходном состоянии

---

### Тест 8: Неверный формат URL

**Шаги:**
1. Ввести неверный URL (например: "not-a-url" или "ftp://example.com")
2. Нажать любую из кнопок

**Ожидаемый результат:**
- ✅ Показывается сообщение об ошибке валидации URL
- ✅ Сообщение указывает на необходимость использования http:// или https://

**Проверка:**
- [ ] Сообщение об ошибке понятное
- [ ] Указан правильный формат URL

---

### Тест 9: Недоступный URL

**Шаги:**
1. Ввести URL несуществующего сайта (например: "https://this-site-does-not-exist-12345.com/article")
2. Нажать любую из кнопок

**Ожидаемый результат:**
- ✅ Показывается сообщение об ошибке подключения к серверу статьи
- ✅ Сообщение понятное и не содержит технических деталей

**Проверка:**
- [ ] Сообщение об ошибке понятное
- [ ] Указано, что проблема с доступностью сайта

---

### Тест 10: Отсутствие API ключа OpenRouter

**Шаги:**
1. Временно удалить или переименовать переменную `OPENROUTER_API_KEY` в `.env.local`
2. Перезапустить сервер
3. Ввести валидный URL статьи
4. Нажать любую из кнопок обработки

**Ожидаемый результат:**
- ✅ Показывается сообщение об ошибке настройки API ключа
- ✅ Сообщение указывает на необходимость проверки `.env.local`

**Проверка:**
- [ ] Сообщение об ошибке понятное
- [ ] Указано место настройки API ключа

---

### Тест 11: Ошибка сети при обращении к OpenRouter API

**Шаги:**
1. Отключить интернет (или использовать инструменты разработчика для блокировки запросов к openrouter.ai)
2. Ввести валидный URL статьи
3. Нажать любую из кнопок обработки

**Ожидаемый результат:**
- ✅ Показывается сообщение об ошибке сети
- ✅ Сообщение предлагает проверить подключение к интернету

**Проверка:**
- [ ] Сообщение об ошибке понятное
- [ ] Указано на проблему с сетью

---

### Тест 12: Превышение лимита запросов (429)

**Шаги:**
1. Выполнить множество запросов подряд (если есть лимит)
2. Или симулировать ошибку 429

**Ожидаемый результат:**
- ✅ Показывается сообщение о превышении лимита запросов
- ✅ Сообщение предлагает подождать и попробовать снова

**Проверка:**
- [ ] Сообщение об ошибке понятное
- [ ] Указано на необходимость подождать

---

## 4.3. Тестирование производительности

### Тест 13: Время отклика API

**Шаги:**
1. Открыть инструменты разработчика (F12)
2. Перейти на вкладку Network
3. Ввести URL статьи
4. Нажать "О чем статья"
5. Записать время выполнения запроса

**Ожидаемый результат:**
- ✅ Время парсинга статьи: < 5 секунд
- ✅ Время генерации описания: < 30 секунд
- ✅ Общее время обработки: < 35 секунд

**Проверка:**
- [ ] Время парсинга приемлемое
- [ ] Время AI-обработки приемлемое
- [ ] Общее время не превышает ожиданий пользователя

---

### Тест 14: Индикаторы загрузки

**Шаги:**
1. Ввести URL статьи
2. Нажать любую из кнопок обработки
3. Наблюдать за индикаторами загрузки

**Ожидаемый результат:**
- ✅ Кнопка показывает состояние загрузки (спиннер и текст "Обработка...")
- ✅ Кнопка неактивна во время загрузки
- ✅ В блоке результата показывается индикатор загрузки
- ✅ После завершения индикаторы исчезают

**Проверка:**
- [ ] Индикаторы загрузки видны
- [ ] Кнопки заблокированы во время обработки
- [ ] Индикаторы исчезают после завершения

---

### Тест 15: Работа с длинными статьями

**Шаги:**
1. Найти длинную статью (более 5000 слов)
2. Ввести URL статьи
3. Нажать "О чем статья"

**Ожидаемый результат:**
- ✅ Статья успешно обрабатывается
- ✅ Результат корректен
- ✅ Время обработки может быть больше, но остается приемлемым (< 60 секунд)

**Проверка:**
- [ ] Длинная статья обрабатывается успешно
- [ ] Результат корректен
- [ ] Производительность приемлемая

---

## 4.4. Интеграционное тестирование

### Тест 16: Последовательное использование всех функций

**Шаги:**
1. Ввести URL статьи
2. Нажать "О чем статья" → дождаться результата
3. Нажать "Тезисы" → дождаться результата
4. Нажать "Пост для Telegram" → дождаться результата

**Ожидаемый результат:**
- ✅ Все три функции работают последовательно
- ✅ Каждая функция использует распарсенные данные (если статья была распарсена)
- ✅ Результаты не конфликтуют друг с другом

**Проверка:**
- [ ] Все функции работают корректно
- [ ] Нет конфликтов между запросами
- [ ] Результаты сохраняются правильно

---

### Тест 17: Переключение между функциями во время обработки

**Шаги:**
1. Ввести URL статьи
2. Нажать "О чем статья"
3. Сразу же нажать "Тезисы" (до завершения первого запроса)

**Ожидаемый результат:**
- ✅ Первый запрос может быть отменен или завершен
- ✅ Второй запрос выполняется корректно
- ✅ Нет конфликтов в состоянии приложения

**Проверка:**
- [ ] Приложение корректно обрабатывает переключение
- [ ] Нет ошибок в консоли
- [ ] Состояние приложения корректное

---

## Чек-лист завершения тестирования

- [ ] Все функциональные тесты пройдены
- [ ] Все тесты обработки ошибок пройдены
- [ ] Тесты производительности выполнены
- [ ] Интеграционные тесты пройдены
- [ ] Нет критических ошибок в консоли браузера
- [ ] Нет критических ошибок в логах сервера
- [ ] Все сообщения об ошибках понятны пользователю
- [ ] Производительность соответствует ожиданиям

## Замечания и рекомендации

1. **Мониторинг**: Рекомендуется добавить логирование времени выполнения запросов для мониторинга производительности
2. **Кэширование**: Рассмотреть возможность кэширования результатов для уже обработанных статей
3. **Таймауты**: Добавить таймауты для запросов к внешним API
4. **Retry логика**: Рассмотреть добавление автоматических повторов при временных ошибках сети

## Дата тестирования

Дата: _______________
Тестировщик: _______________
Результат: _______________

